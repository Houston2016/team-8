function getPixelNearby(image,x,y,diameter){
    var dx = Math.random()*diameter-0.1*diameter;
    var dy = Math.random()*diameter-0.1*diameter;
    var nx = ensureInImage(x+dx, image.getWidth());
    var ny = ensureInImage(y+dy, image.getHeight());
    return image.getPixel(nx,ny);
}
function ensureInImage(coordinate,size){
    if(coordinate<0){
        return 0;
    }
    if(coordinate>=size){
        return size-1;
    }
}
var image = new SimpleImage("http://www.dukelearntoprogram.com/course1/example/smallpanda.png");
var output = new SimpleImage(image.getWidth(),image.getHeight());
for(var p of output.values()){
    var x = p.getX();
    var y = p.getY();
    if(Math.random()>0.95){
        var other = getPixelNearby(image,x,y,5);
        output.setPixel(x,y,other);
    }
    else
        output.setPixel(x,y,image.getPixel(x,y));
}
print(output);


